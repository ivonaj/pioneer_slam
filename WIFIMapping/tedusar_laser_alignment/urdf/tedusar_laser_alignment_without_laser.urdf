<?xml version="1.0"?>
<robot name="tedusar_laser_alignment">
    
    <link name="la_base_link" >
        <visual>
            <geometry>
                <box size="0.03 0.04 0.08"/>
            </geometry>
            <material name="light_gray">
                <color rgba="0.4 0.4 0.4 1.0"/>
            </material>
            <origin rpy="0 0 0" xyz="0 0 0.04"/>
        </visual>
        <collision>
            <geometry>
                <box size="0.03 0.04 0.08"/>
            </geometry>
            <material name="light_gray">
                <color rgba="0.4 0.4 0.4 1.0"/>
            </material>
            <origin rpy="0 0 0" xyz="0 0 0.04"/>
        </collision>
	<inertial>
		<mass value="0.3"/>
		<inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.02" iyz="0.0" izz="0.01"/>
      		<origin rpy="0 0 0" xyz="0 0 0"/><!--Center of mass -->
	</inertial>-->
    </link>
    
    <link name="la_servo1" >
        <visual>
            <geometry>
                <box size="0.035 0.035 0.05"/>
            </geometry>
            <material name="gray">
                <color rgba="0.2 0.2 0.2 1.0"/>
            </material>
            <origin rpy="0 0 0" xyz="-0.0175 0 -0.01"/>
        </visual>
        <collision>
            <geometry>
                <box size="0.035 0.035 0.05"/>
            </geometry>
            <material name="gray">
                <color rgba="0.2 0.2 0.2 1.0"/>
            </material>
            <origin rpy="0 0 0" xyz="-0.0175 0 -0.01"/>
        </collision>
    <inertial>
      <mass value="0.25"/><!-- kg -->
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.02" iyz="0.0" izz="0.01"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
    </inertial><!--Center of mass -->
    </link>
    
    <link name="la_servo1_roll" />
    
    <link name="la_platform" >
        <visual>
            <geometry>
                <box size="0.050 0.050 0.035"/>
            </geometry>
            <material name="light_gray"/>
            <origin rpy="0 0 0" xyz="0 0 0.01"/>
        </visual>
        <collision>
            <geometry>
                <box size="0.050 0.050 0.005"/>
            </geometry>
            <material name="light_gray"/>
            <origin rpy="0 0 0" xyz="0 0 0.01"/>
        </collision>
    <inertial>
      <mass value="0.25"/><!-- kg -->
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.02" iyz="0.0" izz="0.01"/>
      <origin rpy="0 0 0" xyz="0 0 0"/><!--Center of mass -->
    </inertial>
    </link>
    
    <link name="la_laser" >
        <visual>
            <geometry>
                <cylinder length="0.007" radius="0.03"/>
            </geometry>
            <material name="red">
                <color rgba="0.8 0.3 0.2 1.0"/>
            </material>
            <origin rpy="0 0 0" xyz="0 0 -0.018"/>
        </visual>
        <collision>
            <geometry>
                <cylinder length="0.07" radius="0.03"/>
            </geometry>
            <material name="red">
                <color rgba="0.8 0.3 0.2 1.0"/>
            </material>
            <origin rpy="0 0 0" xyz="0 0 -0.018"/>
        </collision>
    <inertial>
      <mass value="0.4"/><!-- kg -->
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.02" iyz="0.0" izz="0.01"/>
      <origin rpy="0 0 0" xyz="0 0 0"/><!--Center of mass -->
    </inertial>
    </link>
    
    <joint name="la_base_to_servo1" type="fixed">
        <parent link="la_base_link"/>
        <child link="la_servo1"/>
        <origin xyz="0 0 0.07" rpy="0 0 0"/>
    </joint>
    
    <joint name="la_roll_joint" type="continuous">
        <parent link="la_servo1"/>
        <child link="la_servo1_roll"/>
        <origin xyz="0 0.0 0" rpy="0 0 0"/>
        <limit effort="35" velocity="10"/>
        <joint_properties damping="30.0" friction="30.0"/>
        <!--<origin xyz="0 0.0 0" rpy="-0.22 0 0"/> small inclination for laser platform -->
    </joint>



    <transmission name="tran1">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="la_roll_joint">
            <hardwareInterface>EffortJointInterface</hardwareInterface>
        </joint>
        <actuator name="motor1">
            <hardwareInterface>EffortJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
        <mechanicalReduction>1</mechanicalReduction>
        <motorTorqueConstant>1</motorTorqueConstant>
    </transmission>

    <gazebo>
        <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">
            <robotNamespace>/p3at</robotNamespace>
        </plugin>
    </gazebo>



    <joint name="la_servo1_roll_la_platform" type="fixed">
        <parent link="la_servo1_roll"/>
        <child link="la_platform"/>
        <origin xyz="0.035 0 -0.065" rpy="0 0 0"/>
    </joint>
    
    <joint name="la_platform_to_laser" type="fixed">
        <parent link="la_platform"/>
        <child link="la_laser"/>
        <origin xyz="0 0 0.066" rpy="0 0 -0.01"/> <!-- 0.066 -->
        <!-- <origin xyz="0 -0.003 0.066" rpy="0 0 -0.01"/> -->
    </joint>


    <gazebo>
        <!--<plugin name="laser" filename="libgazebo_ros_laser.so">
        </plugin> -->
        <!--<include>
            <uri>model://hokuyo</uri>
            <pose>0.345 -0.004 0.35 -0.22 0 0</pose>
        </include>
        <joint name="hokuyo_joint" type="revolute">
          <child>hokuyo::link</child>
          <parent>la_laser</parent>
          <axis>
            <xyz>0 0 1</xyz>
            <limit>
              <upper>0</upper>
              <lower>0</lower>
            </limit>
          </axis>
        </joint>-->
    </gazebo>

    <joint name="hokuyo_joint" type="fixed">
    <axis xyz="0 1 0" />
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <parent link="la_laser"/>
    <child link="hokuyo_link"/>
  </joint>

  <!-- Hokuyo Laser -->
  <link name="hokuyo_link">
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
    <box size="0.1 0.1 0.1"/>
      </geometry>
    </collision>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://rrbot_description/meshes/hokuyo.dae"/>
      </geometry>
    </visual>

    <inertial>
      <mass value="1e-5" />
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6" />
    </inertial>
  </link>
    

<!-- hokuyo -->
<!--
  <gazebo reference="hokuyo_link">
    <sensor type="ray" name="head_hokuyo_sensor">
      <pose>0 0 0 0 0 0</pose>
      <visualize>true</visualize>
      <update_rate>40</update_rate>
      <ray>
        <scan>
          <horizontal>
            <samples>720</samples>
            <resolution>1</resolution>
            <min_angle>-2.35</min_angle>
            <max_angle>2.35</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.10</min>
          <max>20.0</max>
          <resolution>0.01</resolution>
        </range>
        <noise>
          <type>gaussian</type>
          <!-- Noise parameters based on published spec for Hokuyo laser
               achieving "+-30mm" accuracy at range < 10m.  A mean of 0.0m and
               stddev of 0.01m will put 99.7% of samples within 0.03m of the true
               reading. --><!--
          <mean>0.0</mean>
          <stddev>0.01</stddev>
        </noise>
      </ray>
      <plugin name="gazebo_ros_head_hokuyo_controller" filename="libgazebo_ros_laser.so">
        <topicName>/laser/scan</topicName>
        <frameName>hokuyo_link</frameName>
      </plugin>
    </sensor>
  </gazebo>
-->


<!-- testing gazebo imu -->
  <joint name="imu_joint" type="fixed">
      <axis xyz="0 1 0"/>
      <origin xyz="0 0 0.19"/>
      <parent link="base_link"/>
      <child link="imu_link"/>
  </joint>

  <link name="imu_link">
    <inertial>
      <mass value="0.001"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="0.0001" ixy="0" ixz="0" iyy="0.000001" iyz="0" izz="0.0001"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.001 0.001 0.001"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size=".001 .001 .001"/>
      </geometry>
    </collision>
  </link>



  <!--<gazebo>
      <plugin name="imu_plugin" filename="libgazebo_ros_imu.so">
          <alwaysOn>true</alwaysOn>
          <bodyName>imu_link</bodyName>
          <topicName>imu_data</topicName>
          <serviceName>imu_service</serviceName>
          <gaussianNoise>1.0</gaussianNoise>
          <updateRate>10.0</updateRate>
      </plugin>
  </gazebo> -->

  <!--<gazebo>
      <plugin name="imu" filename="libhector_gazebo_ros_imu.so">
        <serviceName>/imu/calibrate</serviceName>
        <updateRate>200.0</updateRate>
        <bodyName>imu_link</bodyName>
        <frameId>imu_link</frameId>
        <topicName>imu</topicName>
        <rpyOffset>0 0 0</rpyOffset>
        <xyzOffset>0 0 0</xyzOffset>
        <gaussianNoise>0.00000001</gaussianNoise>
        <accelDrift>0.00000001 0.00000001 0.00000001</accelDrift>
        <accelDriftFrequency>0.00000001 0.00000001 0.00000001</accelDriftFrequency>
        <accelGaussianNoise>0.00000001 0.00000001 0.00000001</accelGaussianNoise>
        <rateDrift>0.0 0.0 0.0</rateDrift>
        <rateDriftFrequency>0.0 0.0 0.0</rateDriftFrequency>
        <rateGaussianNoise>0.0 0.0 0.0</rateGaussianNoise>
        <headingDrift>0.0 0.0 0.0</headingDrift>
        <headingDriftFrequency>0.0 0.0 0.0</headingDriftFrequency>
        <headingGaussianNoise>0.0 0.0 0.0</headingGaussianNoise>
      </plugin>
    </gazebo>-->
  

</robot>
